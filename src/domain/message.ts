import { Character } from "./character";
import { Scenario } from "./scenario";

export const MESSAGE_IDS = {
  INITIAL_MESSAGE_ID: "initial-message",
  END_MESSAGE_ID: "end-message",
} as const;

// キャラクターとシナリオの組み合わせに応じた初回メッセージ
export const getInitialMessage = (
  character: Character,
  scenario: Scenario
): string => {
  // キャラクターIDとシナリオIDの組み合わせでメッセージを定義
  const messageMap: Record<string, Record<string, string>> = {
    BEGINNER: {
      "new-product":
        "あ、どうも。佐藤です。今日はどんなご用件でしょうか？新しいサービスの話ですか。正直、今のシステムで特に困ってないんですけど...まあ、せっかくなので聞くだけ聞いてみましょうか。",
      "price-negotiation":
        "佐藤です。価格の話ですか...正直、今の予算でギリギリやってるんですよね。値上げの話だったら、ちょっと厳しいかもしれません。でも、まあ話だけは聞きますよ。",
      "internal-project":
        "佐藤です。業務効率化の提案ですか？うーん、今のやり方で特に問題ないと思うんですけど...新しいことを始めるのって、結構大変じゃないですか？でも、どんな内容か教えてください。",
    },
    INTERMEDIATE: {
      "new-product":
        "鈴木です、購買部のマネージャーをしています。新サービスのご提案ということですが、正直なところ、現在のシステムで大きな問題は感じていません。ただ、常により良い選択肢は検討すべきだと思っていますので、どのような価値を提供できるのか、具体的にお聞かせください。",
      "price-negotiation":
        "鈴木です。価格改定のお話ですね。率直に申し上げて、弊社も厳しい状況です。コスト削減は全社的な課題となっています。ただ、長年のお付き合いもありますし、まずは詳細をお聞かせください。どの程度の改定をお考えですか？",
      "internal-project":
        "購買部の鈴木です。業務効率化プロジェクトですか。現場としては、今のプロセスに慣れていますし、大きな変更には抵抗もあるでしょう。投資対効果をしっかり示していただく必要がありますね。どのような改善を想定されていますか？",
    },
    EXPERT: {
      "new-product":
        "高橋です。新しいご提案とのことですが、我が社は30年以上、現在の方法で事業を続けてきました。安易な変更は考えていません。ただし、真に価値のあるものであれば検討の余地はあります。まず、なぜ我が社にこの提案をされるのか、その理由からお聞かせください。",
      "price-negotiation":
        "高橋です。価格の話ですか。30年の取引の中で、様々な局面を共に乗り越えてきましたが、今回はどのような事情でしょうか。ただ、最初に申し上げておきますが、単純な値上げであれば、他社との比較も含めて慎重に検討せざるを得ません。",
      "internal-project":
        "代表の高橋です。社内改革の提案ですね。我が社には長年培ってきた文化と伝統があります。それを変えるには相当な理由が必要です。まず、現状の何が問題だと考えているのか、そしてなぜ今変える必要があるのか、明確に説明してください。",
    },
  };

  // デフォルトメッセージ（マッピングが見つからない場合）
  const defaultMessage = `${character.name}です。本日はお時間をいただきありがとうございます。${scenario.context}`;

  return messageMap[character.id]?.[scenario.id] || defaultMessage;
};

// ステージごとのヒントメッセージ
export const getStageHint = (stage: string): string => {
  const hints: Record<string, string> = {
    導入: "相手との関係構築を意識しましょう。アイスブレイクや共通の話題から始めると効果的です。",
    課題確認:
      "相手の現状や課題を深く理解しましょう。質問を通じて、相手のニーズを引き出すことが重要です。",
    提案: "相手の課題に対する具体的な解決策を提示しましょう。メリットを明確に、デメリットも正直に伝えることが信頼につながります。",
    クロージング:
      "決断を促しましょう。次のステップを明確にし、相手が行動しやすい提案をすることが大切です。",
  };

  return hints[stage] || "";
};
